# 对话

NyaDeskPet 的核心体验是和你的 AI 桌宠对话。本页介绍对话功能的使用方法。

## 目录
- [对话](#对话)
  - [目录](#目录)
  - [基本对话](#基本对话)
  - [对话管理](#对话管理)
    - [多会话](#多会话)
    - [字幕模式](#字幕模式)
  - [斜杠指令](#斜杠指令)
    - [使用方法](#使用方法)
  - [文件和图片上传](#文件和图片上传)
    - [图片理解](#图片理解)
    - [大文件警告](#大文件警告)
  - [摄像头](#摄像头)
  - [语音输入](#语音输入)
  - [触碰交互](#触碰交互)
  - [TTS 语音回复](#tts-语音回复)
  - [系统托盘](#系统托盘)
  - [下一步](#下一步)

---

## 基本对话

<div align="center">
    <img src="./images/chat-overview.png" alt="对话界面" width="300"/>
</div>

1. 在底部的 **输入框** 中输入你想说的话
2. 按 **回车键** 或点击 **发送按钮** 发送消息
3. 角色会以对话气泡的形式回复
4. 如果配置了 TTS，角色还会语音朗读回复并同步口型

> [!TIP]
> 回复过程中你可以看到 AI 在实时“打字”——这是流式输出效果。

---

## 对话管理

### 多会话

<div align="center">
    <img src="./images/chat-sessions.png" alt="多会话管理" width="300"/>
</div>

NyaDeskPet 支持多个独立的对话会话：

- 点击 **对话按钮** 打开侧边栏
- 点击 **+** 创建新的对话
- 在列表中点击历史对话可以切换
- 每个对话有独立的上下文

### 字幕模式

<div align="center">
    <img src="./images/chat-subtitle.png" alt="字幕模式" width="300"/>
</div>

在 **设置 → 显示** 中可以控制 **字幕开关**。开启后，角色回复的文字会以字幕形式显示在模型附近。

---

## 斜杠指令

<div align="center">
    <img src="./images/chat-commands.png" alt="斜杠指令" width="300"/>
</div>

在输入框中输入 `/` 可以触发 **斜杠指令** 自动补全。斜杠指令是快速执行特定操作的快捷方式。

### 使用方法

1. 在输入框中输入 `/`
2. 从弹出的列表中选择指令，或继续输入筛选
3. 部分指令需要参数，会显示参数提示
4. 按下回车执行指令

> [!TIP]
> 指令由 Agent 插件注册，不同的插件可能提供不同的指令。

---

## 文件和图片上传

你可以向 AI 发送文件或图片：

1. 点击输入框旁的 **上传按钮**
2. 选择文件（限制 100MB）
3. 文件会被发送给 AI 处理

### 图片理解

如果上传的是图片文件，AI 会使用视觉能力来理解图片内容并回复。

> [!WARNING]
> 图片理解需要 LLM 供应商支持多模态能力（如 GPT-4o、Claude 3 系列）。

### 大文件警告

上传超过 10MB 的文件时会显示确认提示，以避免因文件过大导致处理缓慢。

---

## 摄像头

你可以截取摄像头画面发送给 AI：

1. 点击 **摄像头按钮**（首次使用需授权）
2. 预览画面后确认截取
3. 截图会作为图片发送给 AI 分析

> [!TIP]
> 摄像头采用延迟初始化——只有在你第一次点击时才会请求摄像头权限，不会在后台偷偷开启。

---

## 语音输入

如果已配置 ASR（参见 [ASR 配置](ASRConfig.md)），你可以通过语音对话：

1. 点击 **麦克风按钮** 开始录音
2. 说话完毕后，静音 1.5 秒自动停止
3. 识别结果会自动填入输入框或直接发送

---

## 触碰交互

你可以直接点击 Live2D 模型的不同部位来触发交互：

- AI 会根据你点击的部位生成对应的反应
- 反应内容取决于角色人设和 AI 的判断
- 可以在 **设置 → 模型** 中启用/禁用特定部位的触碰反应

---

## TTS 语音回复

如果配置了 TTS 供应商（参见 [配置后端 Agent](AgentConfig.md)），角色的回复会以语音朗读：

- **流式音频**：语音和文字同步输出，无需等待完整回复
- **口型同步**：模型嘴型根据音频频率实时变化
- **音量控制**：在 **设置 → 连接** 中调整播放音量

---

## 系统托盘

NyaDeskPet 在系统托盘中提供快捷操作：

| 菜单项 | 说明 |
|--------|------|
| 显示 / 隐藏 | 切换桌宠窗口可见性 |
| UI 切换 | 完整 UI / 纯模型 |
| 对话开关 | 启用/禁用对话功能 |
| 窗口置顶 | 保持窗口在最前 |
| 设置 | 打开设置面板 |
| 插件管理 | 打开插件面板 |
| 退出 | 彻底退出应用 |

---

## 下一步

- 了解插件权限机制：[权限审批](Permissions.md)
- 管理 Agent 插件：[内置 Agent 管理](AgentManagement.md)
